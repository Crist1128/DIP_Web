# 面向基层医院的DIP病种入组辅助平台

## 需求分析

### 功能0：注册与登录

#### 未注册用户

**注册流程更新**：

1. **基本信息收集**：
    - **邮箱（用户名）**：用户提供一个有效的邮箱地址作为用户名。
    - **密码**：用户创建一个密码，并进行**二次输入**以确认无误。
    - **联系电话**：用户提供一个联系电话号码。

2. **地址信息收集（级联选择功能）**：
    - **省（前端展示选项）**：用户首先选择省份，该选择将决定市级选项的展示。
    - **市（前端展示选项）**：基于省份选择，用户随后选择市，确保地址信息的准确性。
    - **准确地址**：用户填写具体的街道地址等详细信息。

3. **医院资质文件上传**：
    - 用户上传医院的资质文件图片，以证明医院的合法性和资质。

4. **实时邮箱验证（新增）**：
    - 在用户提交邮箱地址后，系统自动发送一个验证链接或验证码到该邮箱。
    - 用户需点击链接或输入验证码以验证邮箱所有权，完成邮箱的实时验证。

5. **提交注册信息**：
    - 用户完成所有信息的填写和验证后，提交注册信息。
    - 系统进行初步审查，并将资质文件发送给后台进行人工审核。
    - **等待审核**：用户将被通知其申请已提交并正在审核中。明确说明预计的审核时间，如“审核过程通常需要1-3个工作日”。

6. **审核通过与确认**：
    - 审核通过后，系统向用户邮箱发送确认邮件，告知注册成功并提供登录链接。

#### 已注册用户

- 用户通过输入邮箱和密码进行登录，登录成功后根据用户的角色和权限展示相应的功能和数据。

#### 忘记密码

- 用户在登录界面选择“忘记密码”选项，输入注册时使用的邮箱地址。
- 系统发送重置密码链接或验证码到该邮箱。
- 用户通过邮件中的链接或输入验证码后，进入设置新密码的页面。
- 用户设置新密码并提交，系统更新密码信息。

****

### 功能1：对病历进行入组分析，生成报告

#### 目标

开发一个能够让用户导入病历数据（通过Excel表格），并对这些数据进行分析，以自动地划分病例到不同的DIP病种分组中。分析完成后，系统应该能够展示分组结果，并允许用户下载这些结果的PDF报告。

#### 技术要点

- **Excel处理**：使用如`pandas`库来读取和处理Excel文件数据。
- **数据分析**：设计算法来根据特定规则对病历数据进行分组，还要进行可视化以及数据挖掘。
- **报告生成**：使用Django的模板系统生成报告，然后利用`WeasyPrint`等库将报告从HTML转换为PDF。

### 功能2：查询功能

#### 目标

允许用户通过输入病种名称查询该病种的相关分组信息。这要求系统能够处理查询请求并返回相关的数据。

#### 技术要点

- **数据库设计**：设计合适的数据模型来存储病种及其相关分组信息。
- **REST API**：使用Django REST Framework来创建处理查询请求的API。
- **前端交互**：在Vue前端实现查询界面，允许用户输入查询并展示结果。

### 功能3：用户信息设置

#### 目标

提供一个界面，让用户能够**设置和修改他们的医院信息**

#### 技术要点

- **用户和医院信息管理**：设计数据库模型来存储用户信息、医院信息以及DIP目录库。
- **数据管理界面**：开发前端界面和后端逻辑来允许用户输入和修改信息。
- **认证和权限**：实现用户认证机制，确保数据的安全性和访问控制。

### 功能4：用户自定义导入dip目录表

#### 目标

导入未经过数据清洗的excel格式的dip目录表，后端自动清洗后保存为可用目录表

## 网页设计

